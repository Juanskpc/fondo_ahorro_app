<p-panel>

    <ng-template pTemplate="header">
        <img src="{{cdn}}images/financiacion_proy_inverse.svg" alt="" class="icono-lateral">
        &nbsp; <span class="text-white">Listado de préstamos </span>
    </ng-template>

    <div class="row">
        <div class="col-sm-12 col-md-6 col-lg-8 pull-right d-flex justify-content-end">
            <button type="button" class="btn btn-success" (click)="agregarPrestamo()">
                <img src="{{cdn}}images/plan_desarrollo_inverse.svg" alt="" class="icono-lateral">
                Agregar nuevo préstamo
            </button>
        </div>

        <div class="col-sm-12 col-md-6 col-lg-4">
            <input type="text" class="form-control" placeholder="Buscar por nombre / cédula">
        </div>
    </div>

    <br>

    <p-table [value]="lstPrestamos">
        <ng-template pTemplate="header">
            <tr>
                <th class="text-center">#</th>
                <th>Nombre asociado</th>
                <th>Valor</th>
                <th>Fecha inicio del préstamo</th>
                <th>Estado</th>
                <th>Opciones</th>
            </tr>
        </ng-template>

        <ng-template pTemplate="body" let-prestamo let-rowIndex="rowIndex">
            <tr>
                <td class="text-center">{{rowIndex + 1}}</td>
                <td>{{prestamo.AsociPersona.GenerPersona.primer_nombre}} {{prestamo.AsociPersona.GenerPersona.primer_apellido}}</td>
                <td>{{'$' + (prestamo.valor_prestamo | number:'1.0-0')}}</td>
                <td>{{prestamo.fecha_inicio | date: 'fullDate'}}</td>
                <td class="text-center">
                    <p-tag severity="success" value="ACTIVO"      [rounded]="true" *ngIf="prestamo.estado == 'A'"/>
                    <p-tag severity="secondary"    value="FINALIZADO"  [rounded]="true" *ngIf="prestamo.estado == 'P'"/>
                    <p-tag severity="info" value="SIN DEFINIR" [rounded]="true" *ngIf="prestamo.estado != 'P' && prestamo.estado != 'A'"/>
                </td>
                <td class="text-center">
                    <button type="button" class="btn btn-success" pTooltip="Ver datos">
                        <img src="{{cdn}}images/ver_blanco.svg" alt="" class="icono-lateral">
                    </button>
                </td>
            </tr>
        </ng-template>
    </p-table>

</p-panel>

<p-dialog header="Nuevo prestamo"
    [(visible)]="mostrarNuevoPrestamo" 
    [modal]="true" 
    [style]="{ width: '50vw' }"
    [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }" >

    <span class="text-secondary mb-5">Ingresa la siguiente información para registrar el préstamo.</span>

    <form formGroup="frmPrestamo">

        <div class="row">
            <div class="col-sm-12 col-md-6 col-lg-4 mt-3">
                <label for="">Asociado</label>
                <p-autoComplete 
                formControlName="asociado"
                [suggestions]="lstAsociados" 
                (completeMethod)="buscarAsociadoByNombre($event)" />
            </div>
            <div class="col-sm-12 col-md-6 col-lg-4 mt-3">
                <label for="">Valor del préstamo</label>
                <input type="number" formControlName="valorPrestamo" class="form-control">
            </div>
            <div class="col-sm-12 col-md-6 col-lg-4 mt-3">
                <label for="">Interés</label>
                <input type="number" formControlName="interes" class="form-control">
            </div>
            <div class="col-sm-12 col-md-6 col-lg-4 mt-3">
                <label for="">Fecha inicial</label>
                <input type="date" formControlName="fecInicio" class="form-control">
            </div>
            <div class="col-sm-12 col-md-6 col-lg-4 mt-3">
                <label for="">Fecha final</label>
                <input type="date" formControlName="fecFin" class="form-control">
            </div>
            <div class="col-sm-12 col-md-6 col-lg-4 mt-3">
                <label for="">Descripción</label>
                <input type="text" formControlName="descripcion" class="form-control">
            </div>
        </div>
    </form>
</p-dialog>